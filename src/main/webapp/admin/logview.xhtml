<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" template="/WEB-INF/templates/default.xhtml">

	<ui:define name="title">Logger</ui:define>

	<ui:define name="content">

		<p:layout fullPage="true">

			<p:layoutUnit position="north" header="#{appManager.displayName}">
				<h:form>
					<ui:include src="/includes/menu.xhtml" />
				</h:form>
			</p:layoutUnit>

			<p:layoutUnit position="center">

				<p:ajaxStatus onstart="PF('statusDialog').show();" onsuccess="PF('statusDialog').hide();" />
				<p:dialog modal="false" widgetVar="statusDialog" resizable="false" showHeader="false" draggable="false" closable="false">
					<p:graphicImage value="/images/loading.gif" width="25" />
				</p:dialog>

				<h:form id="form">

					<div style="margin: 5px">
						<h:outputText value="Application Server Log Entries" styleClass="header" />
					</div>
					<div style="margin: 5px">
						<h:outputText value="Inspect WDDR Application Server Log Entries" styleClass="label" />
					</div>
					<div style="text-align: right; margin: 5px">
						<h:graphicImage value="/images/help_icon.gif" height="18" title="LoggerView" onclick="PF('helpDialog').show()" />
					</div>
					<p:messages id="messages" />
					<h:panelGrid columns="4" styleClass="panelGrid" columnClasses="left-120,left-200,left,left">
						<p:outputLabel for="logFileSelect" value="Log File:" />
						<h:panelGroup>
							<p:selectOneMenu id="logFileSelect" value="#{logViewer.selectedLogFile}" style="width:220px" valueChangeListener="#{logViewer.onLogFileChange}">
								<f:selectItem itemLabel="Select Log File" itemValue="" />
								<f:selectItems value="#{logViewer.logFiles}" var="file" itemLabel="#{file}" itemValue="#{file}" />
								<p:ajax update=":form:tablePanel" />
							</p:selectOneMenu>
						</h:panelGroup>
						<p:spacer width="20" />
						<p:commandButton value="Refresh" actionListener="#{logViewer.refresh}" update=":form:tablePanel"/>							
					</h:panelGrid>

					<p:panel id="tablePanel" >
						<f:facet name="header">
						Application Logger
						</f:facet>

						<ui:repeat value="#{logViewer.lines}" var="line">
							<h:outputText value="#{line}" /><br/>
						</ui:repeat>
					</p:panel>

					<div style="text-align: right; margin: 10px">
						<p:commandButton value="Close" action="#{logViewer.close}" style="width:80px" title="Close view" />
					</div>

				</h:form>
			</p:layoutUnit>
			<p:layoutUnit position="south">
				<h:form>
					<ui:include src="/includes/footer.xhtml" />
				</h:form>
			</p:layoutUnit>			
		</p:layout>

		<ui:include src="/includes/helppanel.xhtml">
			<ui:param name="helpResource" value="#{helpManager.getHelp('LoggerView')}" />
		</ui:include>

	</ui:define>
</ui:composition>